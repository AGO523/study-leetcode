def is_valid_sudoku(board)
  row_sets = Array.new(9) { Set.new }
  col_sets = Array.new(9) { Set.new }
  box_sets = Array.new(3) { Array.new(3) { Set.new } }

  (0...9).each do |i|
    (0...9).each do |j|
      # äºŒé‡ãƒ«ãƒ¼ãƒ—ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€
      # [0, 0], [0, 1], [0, 2], ... 
      # [1, 0], [1, 1], [1, 2], ...
      # [2, 0], [2, 1], [2, 2], ...
      #  ã®é †ã«å‡¦ç†ã•ã‚Œã‚‹
      num = board[i][j]
      next if num == "."


      # box_sets ã§ /3 ã—ã¦ã„ã‚‹ã®ã¯ã€
      # i/3 ã¨ j/3 ã‚’è¨ˆç®—ã™ã‚‹ã¨ã€å„ 3Ã—3 ãƒœãƒƒã‚¯ã‚¹ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãŒåˆ†ã‹ã‚‹
      # i / 3 â†’ ç¸¦ã® 3Ã—3 ãƒœãƒƒã‚¯ã‚¹ã®ä½ç½®
      # j / 3 â†’ æ¨ªã® 3Ã—3 ãƒœãƒƒã‚¯ã‚¹ã®ä½ç½®

      # ä¾‹: (i, j) = (4, 7) ã®å ´åˆ
      # i = 4 â†’ i / 3 = 4 / 3 = 1ï¼ˆ1 ç•ªç›®ã® 3Ã—3 ãƒœãƒƒã‚¯ã‚¹ï¼‰
      # j = 7 â†’ j / 3 = 7 / 3 = 2ï¼ˆ2 ç•ªç›®ã® 3Ã—3 ãƒœãƒƒã‚¯ã‚¹ï¼‰
      # ğŸ”¹ ã—ãŸãŒã£ã¦ (4, 7) ã®ã‚»ãƒ«ã¯ box_sets[1][2] ã«å±ã™ã‚‹ã€‚
      if row_sets[i].include?(num) || col_sets[j].include?(num) || box_sets[i/3][j/3].include?(num)
        # ã™ã§ã«åŒã˜æ•°å­—ãŒã‚ã‚‹å ´åˆã¯falseã‚’è¿”ã™
        return false
      end

      # set ã«ç¾åœ¨èµ°æŸ»ã—ã¦ã„ã‚‹æ•°å­—ã‚’è¿½åŠ ã™ã‚‹ã“ã¨ã§ã€
      # æ¬¡å›ã®èµ°æŸ»ã§åŒã˜æ•°å­—ãŒã‚ã‚‹ã‹ã©ã†ã‹ã‚’åˆ¤å®šã™ã‚‹
      row_sets[i].add(num)
      col_sets[j].add(num)
      box_sets[i/3][j/3].add(num)
    end
  end

  true
end
